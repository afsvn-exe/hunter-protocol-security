# VULNERABILITY LOG

> Track every vulnerability discovered, exploited, and fixed throughout the protocol.

---

## Log Format

```
## [DATE] VULN-NNN: Title

**Component:** Which library/tool
**CWE:** CWE-XXX
**Severity:** Critical/High/Medium/Low

### Description
What is the vulnerability?

### Root Cause
Why does it exist? (First principles)

### Exploitation
How can an attacker trigger it? (Code or steps)

### Fix
What change eliminates it? (Code diff)

### Verification
How do we prove the fix works? (Test case, sanitizer output)

### Lessons
What pattern should I recognize in future code?
```

---

## Entries

<!-- Add new entries below this line, newest first -->

### Template Entry (Delete This)

## [YYYY-MM-DD] VULN-001: Example Buffer Overflow in naive_copy

**Component:** safe-string (Week 1)
**CWE:** CWE-120
**Severity:** Critical

### Description
`naive_copy()` copies source string to destination without checking destination buffer size.

### Root Cause
No bounds checking. Function trusts caller to provide adequate buffer.

```c
// Vulnerable pattern
void naive_copy(char *dest, const char *src) {
    while ((*dest++ = *src++) != '\0');  // No limit!
}
```

### Exploitation
```c
char small_buffer[8];
naive_copy(small_buffer, "AAAAAAAAAAAAAAAAAAAAAAAA"); // 24 bytes -> overflow
```

Stack corruption at offset 8, saved RBP at 8, return address at 16.

### Fix
```c
ssize_t ss_copy(char *dest, size_t destsize, const char *src) {
    if (!dest || !src || destsize == 0) return -1;
    
    size_t i = 0;
    while (i < destsize - 1 && src[i] != '\0') {
        dest[i] = src[i];
        i++;
    }
    dest[i] = '\0';
    return (ssize_t)i;
}
```

### Verification
```bash
$ ./test_ss_copy
[PASS] ss_copy truncates oversized input
[PASS] ss_copy always NUL-terminates
[PASS] ASan: no buffer overflow detected
```

### Lessons
- NEVER trust buffer sizes from callers
- ALWAYS take explicit size parameter
- ALWAYS NUL-terminate string outputs
- Pattern: `while (i < size - 1 && ...)` is the bounded loop

---

<!-- Your entries go below -->
